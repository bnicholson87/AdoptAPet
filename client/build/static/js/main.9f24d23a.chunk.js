(this.webpackJsonpproject3=this.webpackJsonpproject3||[]).push([[0],{20:function(e,t,a){e.exports=a(31)},31:function(e,t,a){"use strict";a.r(t);var r,n=a(0),s=a.n(n),c=a(18),l=a.n(c),o=a(9),u=a(1),i=a(3),m=a(8),p={authOk:!1,name:"",tasks:[],alert:""},E=function(e,t){switch(t.type){case"USER_LOGIN":return Object(m.a)(Object(m.a)(Object(m.a)({},e),t.data),{},{alert:t.message||"",authOk:!0});case"USER_LOGOUT":return Object(m.a)(Object(m.a)({},p),{},{alert:t.message||""});case"ALERT_MESSAGE":return Object(m.a)(Object(m.a)({},e),{},{alert:t.message});case"ALERT_CLEAR":return Object(m.a)(Object(m.a)({},e),{},{alert:""});case"UPDATE_TASKS":return Object(m.a)(Object(m.a)({},e),{},{tasks:t.tasks,alert:t.message||""});default:return console.log("Invalid action type: ".concat(t.type)),e}},f=Object(n.createContext)(),b=function(){return Object(n.useContext)(f)},d=function(e){var t=Object(n.useReducer)(E,p),a=Object(i.a)(t,2),r=a[0],c=a[1];return s.a.createElement(f.Provider,Object.assign({value:[r,c]},e))};var g=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],c=t[1],l=b(),m=Object(i.a)(l,1)[0],p=m.authOk,E=m.name,f=Object(u.f)();return Object(n.useEffect)((function(){a&&(r&&clearTimeout(r),r=setTimeout((function(){c(!1)}),2e3))}),[a]),Object(n.useEffect)((function(){r&&clearTimeout(r),c(!1)}),[f]),s.a.createElement(s.a.Fragment,null,p?s.a.createElement("nav",{class:"navbar navbar-expand-lg navbar-light bg-light"},s.a.createElement(o.c,{to:"/",className:"navbar-brand"},s.a.createElement("img",{src:"https://upload.wikimedia.org/wikipedia/commons/7/79/Mountain_icon_%28Noun_Project%29.svg",alt:"",width:"64",height:"64"})),s.a.createElement("button",{onClick:function(){return c(!a)},class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbar"},s.a.createElement("span",{class:"navbar-toggler-icon"})),s.a.createElement("div",{className:"collapse navbar-collapse "+(a?"show":""),id:"navbar"},s.a.createElement("ul",{class:"navbar-nav me-auto mb-2 mb-lg-0"},s.a.createElement("li",{className:"nav-item"},s.a.createElement(o.c,{to:"/tasks",className:"nav-link",activeClassName:"active"},"Tasks")),s.a.createElement("li",{className:"nav-item"},s.a.createElement(o.c,{to:"/logout",className:"nav-link"},"Logout"))),E&&s.a.createElement("div",{class:"d-flex"},s.a.createElement("div",{class:"mx-3"},"Welcome back ",s.a.createElement("u",null,E))))):s.a.createElement(u.a,{to:"/login"}))};var v,h=function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("hr",null),s.a.createElement("div",{id:"footer-padding"}),s.a.createElement("div",{id:"footer"},"(c) 202x Project#3 Team"))};var O=function(){var e=b(),t=Object(i.a)(e,2),a=t[0].alert,r=t[1];function c(){v&&clearTimeout(v),r({type:"ALERT_CLEAR"})}return Object(n.useEffect)((function(){a&&(v&&clearTimeout(v),v=setTimeout(c,5e3))}),[a]),s.a.createElement(s.a.Fragment,null,a&&s.a.createElement("div",{onClick:c,class:"navbar fixed-top alert alert-warning mx-5"},a))},k=a(4),y=a.n(k),j=a(10);var S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"get",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={method:t,headers:{"Content-Type":"application/json",Session:localStorage.session||""}};return"post"!==t&&"put"!==t||(r.body=JSON.stringify(a)),fetch(e,r).then((function(e){return e.json()}))};var x=function(){var e=b(),t=Object(i.a)(e,2),a=t[0],r=a.alert,c=a.tasks,l=t[1],o=Object(n.useRef)();function u(){return(u=Object(j.a)(y.a.mark((function e(){var t,a,r,n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S("/api/tasks");case 2:if(t=e.sent,a=t.status,r=t.tasks,n=t.message,a){e.next=9;break}return l({type:"ALERT_MESSAGE",message:n}),e.abrupt("return");case 9:console.log(".. GET /api/tasks, tasks:",r),l({type:"UPDATE_TASKS",tasks:r});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return(m=Object(j.a)(y.a.mark((function e(t){var a,r,n,s,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=o.current.value,o.current.value="",e.next=5,S("/api/tasks","post",{task:a});case 5:if(r=e.sent,n=r.status,s=r.tasks,c=r.message,n){e.next=12;break}return l({type:"ALERT_MESSAGE",message:c}),e.abrupt("return");case 12:l({type:"UPDATE_TASKS",tasks:s,message:c});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){!function(){u.apply(this,arguments)}()}),[]),s.a.createElement("form",null,s.a.createElement("div",{class:"card"},s.a.createElement("div",{class:"card-header"},s.a.createElement("h1",null,"Task List")),s.a.createElement("div",{class:"card-body"},s.a.createElement("ul",{id:"taskList",class:"list-group"},c&&c.map((function(e){return s.a.createElement("li",{class:"list-group-item"},e.name)})))),s.a.createElement("div",{class:"card-footer"},s.a.createElement("div",{class:"input-group"},s.a.createElement("input",{ref:o,type:"text",class:"form-control",placeholder:"New Task..."}),s.a.createElement("button",{onClick:function(e){return m.apply(this,arguments)},disabled:r.length>0,class:"btn btn-primary"},"Save")))))};var w=function(){var e=b(),t=Object(i.a)(e,2),a=t[0].authOk,r=t[1],c=Object(n.useRef)(),l=Object(n.useRef)(),m=Object(n.useRef)();function p(){return(p=Object(j.a)(y.a.mark((function e(t){var a,n,s,o,u,i;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!((a={name:m.current.value.trim(),email:c.current.value.trim(),password:l.current.value.trim()}).name.length<3)){e.next=6;break}return m.current.focus(),r({type:"ALERT_MESSAGE",message:"You need a longer name"}),e.abrupt("return");case 6:if(!(a.email.indexOf("@")<3)){e.next=10;break}return c.current.focus(),r({type:"ALERT_MESSAGE",message:"You need a leggit email"}),e.abrupt("return");case 10:if(!(a.password.length<5)){e.next=14;break}return l.current.focus(),r({type:"ALERT_MESSAGE",message:"You need a longer password"}),e.abrupt("return");case 14:return e.next=16,S("/api/users/register","post",a);case 16:if(n=e.sent,s=n.status,o=n.session,u=n.userData,i=n.message,s){e.next=25;break}return localStorage.session="",r({type:"ALERT_MESSAGE",message:i}),e.abrupt("return");case 25:localStorage.session=o,r({type:"USER_LOGIN",data:u,message:i});case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){c.current.value=localStorage.email||""}),[]),s.a.createElement(s.a.Fragment,null,a?s.a.createElement(u.a,{to:"/tasks"}):"",s.a.createElement("form",null,s.a.createElement("div",{class:"card mt-5"},s.a.createElement("div",{class:"card-header"},s.a.createElement("h1",null,"User Registration")),s.a.createElement("div",{class:"card-body"},s.a.createElement("div",{class:"mb-3"},s.a.createElement("label",{for:"name"},"First Name"),s.a.createElement("input",{ref:m,type:"text",id:"name",class:"form-control"})),s.a.createElement("div",{class:"mb-3"},s.a.createElement("label",{for:"email"},"Email Address"),s.a.createElement("input",{ref:c,id:"email",type:"email",class:"form-control"})),s.a.createElement("div",{class:"mb-3"},s.a.createElement("label",{for:"userPassword"},"Password"),s.a.createElement("input",{ref:l,id:"userPassword",type:"password",class:"form-control"}))),s.a.createElement("div",{class:"card-footer"},s.a.createElement("button",{onClick:function(e){return p.apply(this,arguments)},class:"btn btn-primary mx-1"},"Register"),s.a.createElement(o.b,{to:"/login",class:"font-weight-light text-muted mx-3"},"Already Registered?")))))};var A=function(){var e=b(),t=Object(i.a)(e,2),a=t[0].authOk,r=t[1],c=Object(n.useRef)(),l=Object(n.useRef)(),m=Object(n.useRef)();function p(){return(p=Object(j.a)(y.a.mark((function e(t){var a,n,s,o,u,i;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("[userLogin]"),t.preventDefault(),""!==(a={email:c.current.value,password:l.current.value,rememberMe:m.current.checked}).email){e.next=7;break}return c.current.focus(),r({type:"ALERT_MESSAGE",message:"Please enter your email!"}),e.abrupt("return");case 7:if(!(""===a.password||a.password.length<8)){e.next=11;break}return l.current.focus(),r({type:"ALERT_MESSAGE",message:"Please enter your password!"}),e.abrupt("return");case 11:return e.next=13,S("/api/users/login","post",a);case 13:if(n=e.sent,s=n.status,o=n.session,u=n.userData,i=n.message,s){e.next=22;break}return localStorage.session="",r({type:"ALERT_MESSAGE",message:i}),e.abrupt("return");case 22:m.current.checked?localStorage.email=c.current.value:localStorage.email="",localStorage.session=o,r({type:"USER_LOGIN",data:u});case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){c.current.value=localStorage.email||"",m.current.checked=!0}),[]),s.a.createElement(s.a.Fragment,null,a?s.a.createElement(u.a,{to:"/tasks"}):"",s.a.createElement("form",null,s.a.createElement("div",{class:"card mt-5"},s.a.createElement("div",{class:"card-header"},s.a.createElement("h1",null,"Login")),s.a.createElement("div",{class:"card-body"},s.a.createElement("div",{class:"mb-3"},s.a.createElement("label",{for:"email",class:"form-label"},"Email address"),s.a.createElement("input",{ref:c,id:"email",type:"email",class:"form-control"})),s.a.createElement("div",{class:"mb-3"},s.a.createElement("label",{for:"userPassword"},"Password"),s.a.createElement("input",{ref:l,id:"userPassword",type:"password",class:"form-control"}))),s.a.createElement("div",{class:"card-footer"},s.a.createElement("button",{onClick:function(e){return p.apply(this,arguments)},type:"button",class:"btn btn-primary mx-1"},"Login"),"\xa0",s.a.createElement("input",{ref:m,id:"rememberMe",type:"checkbox"}),s.a.createElement("label",{class:"text-secondary",for:"rememberMe"},"Remember Me")," \xa0",s.a.createElement(o.b,{to:"/register",class:"mx-3"},"Need to Register?")))))};var R=function(){var e=b(),t=Object(i.a)(e,2),a=t[0].authOk,r=t[1];function c(){return(c=Object(j.a)(y.a.mark((function e(){var t,a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S("/api/users/logout");case 2:t=e.sent,a=t.message,localStorage.session="",r({type:"USER_LOGOUT",message:a});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){!function(){c.apply(this,arguments)}()}),[]),s.a.createElement(s.a.Fragment,null,!a&&s.a.createElement(u.a,{to:"/login"}),s.a.createElement("h1",null,"Please wait, logging out..."))};var T=function(){return s.a.createElement(d,null,s.a.createElement(o.a,null,s.a.createElement("div",{class:"container"},s.a.createElement(O,null),s.a.createElement(g,null),s.a.createElement(u.b,{exact:!0,path:["/","/tasks"],component:x}),s.a.createElement(u.b,{exact:!0,path:"/register",component:w}),s.a.createElement(u.b,{exact:!0,path:"/login",component:A}),s.a.createElement(u.b,{exact:!0,path:"/logout",component:R}),s.a.createElement(h,null))))};l.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(T,null)),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.9f24d23a.chunk.js.map